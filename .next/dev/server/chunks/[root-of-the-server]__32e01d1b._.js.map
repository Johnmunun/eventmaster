{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///H:/React_projets/EventMaster/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\n// Empêche Prisma d'être chargé dans le runtime edge\nif (typeof window !== \"undefined\") {\n  throw new Error(\"❌ Prisma ne peut pas être utilisé dans le frontend.\");\n}\n\nif (process.env.NEXT_RUNTIME === \"edge\") {\n  throw new Error(\"❌ Prisma ne peut pas être utilisé dans le runtime Edge.\");\n}\n\nexport const db =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log:\n      process.env.NODE_ENV === 'development'\n        ? ['error', 'warn']\n        : ['error'],\n  });\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = db;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIxB,oDAAoD;AACpD;;AAIA;;AAIO,MAAM,KACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KACE,uCACI;QAAC;QAAS;KAAO,GACjB;AACR;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///H:/React_projets/EventMaster/lib/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\"\nimport { PrismaAdapter } from \"@auth/prisma-adapter\"\nimport Credentials from \"next-auth/providers/credentials\"\nimport Google from \"next-auth/providers/google\"\nimport { db } from \"@/lib/db\"\nimport bcrypt from \"bcryptjs\"\nimport dotenv from \"dotenv\"\n\n// Charger les variables d'environnement\ndotenv.config({ path: '.env' })\n\nexport const { handlers, signIn, signOut, auth } = NextAuth({\n  adapter: PrismaAdapter(db) as any,\n  providers: [\n    Credentials({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"Email\", type: \"email\" },\n        password: { label: \"Password\", type: \"password\" }\n      },\n      async authorize(credentials) {\n        if (!credentials?.email || !credentials?.password) {\n          throw new Error(\"Email et mot de passe requis\")\n        }\n\n        const user = await db.user.findUnique({\n          where: {\n            email: credentials.email as string\n          }\n        })\n\n        if (!user || !user.password) {\n          throw new Error(\"Email ou mot de passe incorrect\")\n        }\n\n        const isPasswordValid = await bcrypt.compare(\n          credentials.password as string,\n          user.password\n        )\n\n        if (!isPasswordValid) {\n          throw new Error(\"Email ou mot de passe incorrect\")\n        }\n\n        return {\n          id: user.id,\n          email: user.email,\n          name: user.name,\n          image: user.image,\n          role: user.role,\n        }\n      }\n    }),\n    Google({\n      clientId: process.env.GOOGLE_CLIENT_ID || \"\",\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET || \"\",\n    })\n  ],\n  session: {\n    strategy: \"jwt\",\n  },\n  pages: {\n    signIn: \"/login\",\n    signOut: \"/\",\n  },\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        token.id = user.id\n        token.role = (user as any).role\n      }\n      return token\n    },\n    async session({ session, token }) {\n      if (session.user) {\n        session.user.id = token.id as string\n        session.user.role = token.role as string\n      }\n      return session\n    },\n  },\n  secret: process.env.NEXTAUTH_SECRET,\n  trustHost: true, // Nécessaire pour Next.js 16\n})\n\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;;;;;;;;AAEA,wCAAwC;AACxC,gJAAM,CAAC,MAAM,CAAC;IAAE,MAAM;AAAO;AAEtB,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,gKAAQ,EAAC;IAC1D,SAAS,IAAA,qKAAa,EAAC,+GAAE;IACzB,WAAW;QACT,IAAA,qMAAW,EAAC;YACV,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;oBACjD,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,OAAO,MAAM,+GAAE,CAAC,IAAI,CAAC,UAAU,CAAC;oBACpC,OAAO;wBACL,OAAO,YAAY,KAAK;oBAC1B;gBACF;gBAEA,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;oBAC3B,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,kBAAkB,MAAM,4IAAM,CAAC,OAAO,CAC1C,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAGf,IAAI,CAAC,iBAAiB;oBACpB,MAAM,IAAI,MAAM;gBAClB;gBAEA,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;oBACf,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;QACA,IAAA,gMAAM,EAAC;YACL,UAAU,QAAQ,GAAG,CAAC,gBAAgB,IAAI;YAC1C,cAAc,QAAQ,GAAG,CAAC,oBAAoB,IAAI;QACpD;KACD;IACD,SAAS;QACP,UAAU;IACZ;IACA,OAAO;QACL,QAAQ;QACR,SAAS;IACX;IACA,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,AAAC,KAAa,IAAI;YACjC;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;gBAC1B,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAChC;YACA,OAAO;QACT;IACF;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;IACnC,WAAW;AACb"}},
    {"offset": {"line": 210, "column": 0}, "map": {"version":3,"sources":["file:///H:/React_projets/EventMaster/proxy.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport type { NextRequest } from \"next/server\"\nimport { auth } from \"@/lib/auth\"\n\nexport async function proxy(request: NextRequest) {\n  const session = await auth()\n  const pathname = request.nextUrl.pathname\n\n  // Routes publiques\n  const publicPaths = [\"/\", \"/login\", \"/signup\", \"/api/auth\"]\n  const isPublicPath = publicPaths.some(path => \n    pathname === path || pathname.startsWith(path)\n  )\n\n  // Si c'est une route publique, autoriser l'accès\n  if (isPublicPath) {\n    // Rediriger les utilisateurs connectés qui essaient d'accéder aux pages d'auth\n    if (session && (pathname.startsWith(\"/login\") || pathname.startsWith(\"/signup\"))) {\n      return NextResponse.redirect(new URL(\"/dashboard\", request.url))\n    }\n    return NextResponse.next()\n  }\n\n  // Routes protégées - vérifier l'authentification\n  if (!session) {\n    const loginUrl = new URL(\"/login\", request.url)\n    loginUrl.searchParams.set(\"callbackUrl\", pathname)\n    return NextResponse.redirect(loginUrl)\n  }\n\n  // Vérifier les routes admin\n  if (pathname.startsWith(\"/admin\")) {\n    const userRole = (session.user as any)?.role\n    if (userRole !== \"ADMIN\") {\n      return NextResponse.redirect(new URL(\"/dashboard\", request.url))\n    }\n  }\n\n  return NextResponse.next()\n}\n\nexport const config = {\n  matcher: [\n    \"/dashboard/:path*\",\n    \"/admin/:path*\",\n    \"/login\",\n    \"/signup\",\n  ],\n}\n\n"],"names":[],"mappings":";;;;;;AAAA;AAEA;;;AAEO,eAAe,MAAM,OAAoB;IAC9C,MAAM,UAAU,MAAM,IAAA,mHAAI;IAC1B,MAAM,WAAW,QAAQ,OAAO,CAAC,QAAQ;IAEzC,mBAAmB;IACnB,MAAM,cAAc;QAAC;QAAK;QAAU;QAAW;KAAY;IAC3D,MAAM,eAAe,YAAY,IAAI,CAAC,CAAA,OACpC,aAAa,QAAQ,SAAS,UAAU,CAAC;IAG3C,iDAAiD;IACjD,IAAI,cAAc;QAChB,+EAA+E;QAC/E,IAAI,WAAW,CAAC,SAAS,UAAU,CAAC,aAAa,SAAS,UAAU,CAAC,UAAU,GAAG;YAChF,OAAO,8IAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;QAChE;QACA,OAAO,8IAAY,CAAC,IAAI;IAC1B;IAEA,iDAAiD;IACjD,IAAI,CAAC,SAAS;QACZ,MAAM,WAAW,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9C,SAAS,YAAY,CAAC,GAAG,CAAC,eAAe;QACzC,OAAO,8IAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,4BAA4B;IAC5B,IAAI,SAAS,UAAU,CAAC,WAAW;QACjC,MAAM,WAAY,QAAQ,IAAI,EAAU;QACxC,IAAI,aAAa,SAAS;YACxB,OAAO,8IAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;QAChE;IACF;IAEA,OAAO,8IAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;QACA;QACA;QACA;KACD;AACH"}}]
}